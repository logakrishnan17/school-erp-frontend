(this["webpackJsonpschool-erp-frontend"]=this["webpackJsonpschool-erp-frontend"]||[]).push([[0],{42:function(e,t,a){e.exports=a.p+"static/media/logo.5d5d9eef.svg"},53:function(e,t,a){e.exports=a(86)},58:function(e,t,a){},86:function(e,t,a){"use strict";a.r(t);var n=a(0),o=a.n(n),s=a(20),r=a.n(s),l=(a(58),a(11)),i=a(12),c=a(14),u=a(13),h=a(24),m=a(5),d=(a(59),a(27)),p=a.n(d),g=a(40),f=a(4),v=a(41),b=a.n(v),E=a(15),y=a.n(E),k="https://school-erp-backend.herokuapp.com/";function S(e){return y.a.get(k+"/user",{headers:{"Content-Type":"application/json",Authorization:e}}).then((function(e){return console.log(e.data),e.data})).catch((function(e){return console.log(e),e}))}var C=function(){function e(t){Object(l.a)(this,e),this.login=this.login.bind(this),this.getProfile=this.getProfile.bind(this)}return Object(i.a)(e,[{key:"login",value:function(e){var t=this;return function(e){return y.a.post(k+"/user/login",e).then((function(e){return console.log(e.data),e.data})).catch((function(e){return console.log(e,"err"),e}))}(e).then((function(e){return e.token&&t.setToken(e.token),Promise.resolve(e)}))}},{key:"loggedIn",value:function(){return!!this.getToken()}},{key:"setToken",value:function(e){localStorage.setItem("token",e)}},{key:"getToken",value:function(){return localStorage.getItem("token")}},{key:"logout",value:function(){localStorage.removeItem("token")}},{key:"getProfile",value:function(){return b()(this.getToken())}},{key:"_checkStatus",value:function(e){if(e.status>=200&&e.status<300)return e;var t=new Error(e.statusText);throw t.response=e,t}}]),e}(),O=a(91),j=a(42),D=a.n(j),N=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).handleAddStudent=n.handleAddStudent.bind(Object(f.a)(n)),n.handleListStudent=n.handleListStudent.bind(Object(f.a)(n)),n.handleLogout=n.handleLogout.bind(Object(f.a)(n)),n.Auth=new C,n}return Object(i.a)(a,[{key:"handleAddStudent",value:function(e){return this.props.history.push("/create")}},{key:"handleListStudent",value:function(e){return this.props.history.push("/list")}},{key:"handleLogout",value:function(e){return this.Auth.logout(),this.props.history.push("/")}},{key:"render",value:function(){return o.a.createElement("div",{className:"container"},o.a.createElement("nav",{className:"navbar navbar-expand-lg navbar-light bg-light"},o.a.createElement("span",null,o.a.createElement("img",{src:D.a,width:"30",height:"30",alt:""}),o.a.createElement(h.b,{to:"/list",className:"navbar-brand"},"School ERP")),o.a.createElement(O.a,{title:"Student"},o.a.createElement(O.a.Item,{eventKey:"1.1",onSelect:this.handleAddStudent},"Add Student"),o.a.createElement(O.a.Item,{eventKey:"1.1",onSelect:this.handleListStudent},"List Students")),o.a.createElement("button",{className:"btn-danger",onClick:this.handleLogout},"Logout")),o.a.createElement("br",null))}}]),a}(n.Component),w=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).state={name:"",DOB:"",classId:"",year:"",parentId:"",classList:[],parentsList:[]},n.onChangeName=n.onChangeName.bind(Object(f.a)(n)),n.onChangeDOB=n.onChangeDOB.bind(Object(f.a)(n)),n.onChangeClass=n.onChangeClass.bind(Object(f.a)(n)),n.onChangeYear=n.onChangeYear.bind(Object(f.a)(n)),n.onChangeParent=n.onChangeParent.bind(Object(f.a)(n)),n.onSubmit=n.onSubmit.bind(Object(f.a)(n)),n.Auth=new C,n}return Object(i.a)(a,[{key:"onChangeName",value:function(e){this.setState({name:e.target.value})}},{key:"onChangeDOB",value:function(e){this.setState({DOB:e.target.value})}},{key:"onChangeClass",value:function(e){this.setState({classId:e.target.value})}},{key:"onChangeYear",value:function(e){this.setState({year:e.target.value})}},{key:"onChangeParent",value:function(e){this.setState({parentId:e.target.value})}},{key:"componentDidMount",value:function(){var e=Object(g.a)(p.a.mark((function e(){var t,a;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=[],a=[],this.Auth.loggedIn()){e.next=3;break}return e.abrupt("return",this.props.history.replace("/"));case 3:return e.next=5,(n=this.Auth.getToken(),y.a.get(k+"/class",{headers:{"Content-Type":"application/json",Authorization:n}}).then((function(e){return console.log(e.data),e.data})).catch((function(e){return console.log(e),e}))).then((function(e){console.log(e),e&&(t=e.data)}));case 5:return e.next=7,S(this.Auth.getToken()).then((function(e){console.log(e),e&&(a=e.data)}));case 7:this.props.history&&this.props.history.location.state&&this.props.history.location.state.editData?this.setState({name:this.props.history.location.state.editData.name,DOB:this.props.history.location.state.editData.DOB,classId:this.props.history.location.state.editData.classId,year:this.props.history.location.state.editData.year,parentId:this.props.history.location.state.editData.parentId,classList:t,parentsList:a}):this.setState({classList:t,parentsList:a}),console.log(this.history,"this.history");case 9:case"end":return e.stop()}var n}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"onSubmit",value:function(e){var t=this;e.preventDefault();var a,n,o={name:this.state.name,DOB:this.state.DOB,classId:this.state.classId,year:this.state.year,parentId:this.state.parentId};(a=this.Auth.getToken(),n=o,y.a.post(k+"/student",n,{headers:{"Content-Type":"application/json",Authorization:a}}).then((function(e){return console.log(e.data),e.data})).catch((function(e){return console.log(e,"err"),e}))).then((function(e){console.log(e),e&&e.status&&200===e.status.code&&t.props.history.push("/list")}))}},{key:"render",value:function(){var e=this.state,t=e.parentsList,a=e.classList;return o.a.createElement("div",{style:{marginTop:10}},o.a.createElement(N,{history:this.props.history}),o.a.createElement("form",{onSubmit:this.onSubmit},o.a.createElement("div",{className:"form-group"},o.a.createElement("label",null,"Name: "),o.a.createElement("input",{type:"text",className:"form-control",value:this.state.name,onChange:this.onChangeName})),o.a.createElement("div",{className:"form-group"},o.a.createElement("label",null,"DOB: "),o.a.createElement("input",{type:"date",className:"form-control",value:this.state.DOB,onChange:this.onChangeDOB})),o.a.createElement("div",{className:"form-group"},o.a.createElement("label",null,"Class: "),o.a.createElement("select",{required:!0,name:"classId",className:"form-control",value:this.state.classId,onChange:this.onChangeClass},o.a.createElement("option",{value:""},"Select class"),a&&a.length?a.map((function(e){return o.a.createElement("option",{key:e._id,value:e._id},e.name+" "+e.section)})):"")),o.a.createElement("div",{className:"form-group"},o.a.createElement("label",null,"Year: "),o.a.createElement("select",{required:!0,type:"text",className:"form-control",value:this.state.year,onChange:this.onChangeYear},o.a.createElement("option",{value:""},"Select Year"),o.a.createElement("option",{value:"2020"},"2020"),o.a.createElement("option",{value:"2019"},"2019"),o.a.createElement("option",{value:"2018"},"2018"),o.a.createElement("option",{value:"2017"},"2017"),o.a.createElement("option",{value:"2016"},"2016"))),o.a.createElement("div",{className:"form-group"},o.a.createElement("label",null,"Parent: "),o.a.createElement("select",{required:!0,name:"parentId",className:"form-control",value:this.state.parentId,onChange:this.onChangeParent},o.a.createElement("option",{value:""},"Select parent"),t&&t.length?t.map((function(e){return o.a.createElement("option",{key:e._id,value:e._id},e.name)})):"")),o.a.createElement("div",{className:"form-group text-center"},o.a.createElement("input",{type:"submit",value:"Submit",className:"btn btn-primary"}))))}}]),a}(n.Component),A=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).student=function(e,t){return o.a.createElement("tr",{key:t},o.a.createElement("td",null,e.name?e.name:"-"),o.a.createElement("td",null,e.classDetails?e.classDetails.name:"-"),o.a.createElement("td",null,e.year?e.year:"-"),o.a.createElement("td",null,e.DOB?e.DOB:"-"),o.a.createElement("td",null,e.parentDetails?e.parentDetails.name:"-"),o.a.createElement("td",null,e.fee?e.fee:"-"),o.a.createElement("td",null,e.isPaidFee?"Paid":"Unpaid"),o.a.createElement("td",null,e.parentDetails?o.a.createElement("button",{disabled:!0,className:"btn-success btn-disabled"},"Assigned"):o.a.createElement("button",{className:"btn-primary",onClick:function(){return n.updateStudent(e._id)}},"Assign")),o.a.createElement("td",null,o.a.createElement("button",{className:"btn-danger",onClick:function(){return n.deleteStudent(e._id)}},"Delete")))},n.state={studentsData:[]},n.Auth=new C,n.studentsList=n.studentsList.bind(Object(f.a)(n)),n.student=n.student.bind(Object(f.a)(n)),n.updateStudent=n.updateStudent.bind(Object(f.a)(n)),n.deleteStudent=n.deleteStudent.bind(Object(f.a)(n)),n}return Object(i.a)(a,[{key:"componentDidMount",value:function(){var e,t=this;if(!this.Auth.loggedIn())return this.props.history.replace("/");(e=this.Auth.getToken(),y.a.get(k+"/student",{headers:{"Content-Type":"application/json",Authorization:e}}).then((function(e){return console.log(e.data),e.data})).catch((function(e){return console.log(e),e}))).then((function(e){console.log(e,"studentsData"),e.data&&t.setState({studentsData:e.data})}))}},{key:"updateStudent",value:function(e){var t=this.state.studentsData.find((function(t){return t._id.toString()===e.toString()}));this.props.history.replace("/edit/"+e,{editData:t})}},{key:"deleteStudent",value:function(e){var t,a,n=this;(t=this.Auth.getToken(),a=e,y.a.delete("".concat(k,"/student/").concat(a),{headers:{"Content-Type":"application/json",Authorization:t}}).then((function(e){return console.log(e.data),e.data})).catch((function(e){return console.log(e),e}))).then((function(t){if(t&&t.status&&200===t.status.code){var a=n.state.studentsData.filter((function(t){return t._id.toString()!==e.toString()}));n.setState({studentsData:a})}}))}},{key:"onSubmit",value:function(e){var t=this;e.preventDefault();var a={email:this.state.email,password:this.state.password};console.log(a,"loginData"),this.Auth.login(a).then((function(e){console.log(e,"tes"),e&&e.status&&200===e.status.code&&(t.Auth.setToken(e.token),t.props.history.replace("/list"))})).catch((function(e){console.log(e)}))}},{key:"studentsList",value:function(){var e=this;return this.state.studentsData.map((function(t,a){return e.student(t,a)}))}},{key:"render",value:function(){return o.a.createElement("div",{className:"col-md-12"},o.a.createElement(N,{history:this.props.history}),o.a.createElement("h3",{className:"text-center"},"Students List"),o.a.createElement("table",{className:"table table-striped",style:{marginTop:20}},o.a.createElement("thead",null,o.a.createElement("tr",null,o.a.createElement("th",null,"Name"),o.a.createElement("th",null,"Class"),o.a.createElement("th",null,"Year"),o.a.createElement("th",null,"Date of Birth"),o.a.createElement("th",null,"Parent"),o.a.createElement("th",null,"Fees"),o.a.createElement("th",null,"Paid Status"),o.a.createElement("th",null,"Assign Parent"),o.a.createElement("th",null,"Delete Student"))),o.a.createElement("tbody",null,this.studentsList())))}}]),a}(n.Component),I=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).state={email:"",password:""},n.onChangeEmail=n.onChangeEmail.bind(Object(f.a)(n)),n.onChangePassword=n.onChangePassword.bind(Object(f.a)(n)),n.onSubmit=n.onSubmit.bind(Object(f.a)(n)),n.Auth=new C,n}return Object(i.a)(a,[{key:"componentDidMount",value:function(){this.Auth.loggedIn()&&this.props.history.replace("/list")}},{key:"onChangeEmail",value:function(e){this.setState({email:e.target.value})}},{key:"onChangePassword",value:function(e){this.setState({password:e.target.value})}},{key:"onSubmit",value:function(e){var t=this;e.preventDefault();var a={email:this.state.email,password:this.state.password};this.Auth.login(a).then((function(e){e&&e.status&&200===e.status.code&&(t.Auth.setToken(e.token),t.props.history.replace("/list"))})).catch((function(e){console.log(e)}))}},{key:"render",value:function(){return o.a.createElement("div",{id:"login"},o.a.createElement("h3",{className:"text-center text-white pt-5"},"Login form"),o.a.createElement("div",{className:"container"},o.a.createElement("div",{id:"login-row",className:"row justify-content-center align-items-center"},o.a.createElement("div",{id:"login-column",className:"col-md-6"},o.a.createElement("div",{id:"login-box",className:"col-md-12"},o.a.createElement("form",{onSubmit:this.onSubmit},o.a.createElement("h3",{className:"text-center text-info"},"Login"),o.a.createElement("div",{className:"form-group"},o.a.createElement("label",{htmlFor:"username",className:"text-info"},"Username:"),o.a.createElement("br",null),o.a.createElement("input",{type:"text",name:"username",id:"username",className:"form-control",value:this.state.email,onChange:this.onChangeEmail})),o.a.createElement("div",{className:"form-group"},o.a.createElement("label",{htmlFor:"password",className:"text-info"},"Password:"),o.a.createElement("br",null),o.a.createElement("input",{type:"password",name:"password",id:"password",className:"form-control",value:this.state.password,onChange:this.onChangePassword})),o.a.createElement("div",{className:"form-group text-center"},o.a.createElement("input",{type:"submit",name:"submit",className:"btn btn-info btn-md",value:"submit"}))))))))}}]),a}(n.Component),L=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(){return Object(l.a)(this,a),t.apply(this,arguments)}return Object(i.a)(a,[{key:"render",value:function(){return o.a.createElement(h.a,null,o.a.createElement(m.a,{path:"/",exact:!0,component:I}),o.a.createElement("div",{className:"container"},o.a.createElement(m.a,{path:"/list",exact:!0,component:A}),o.a.createElement(m.a,{path:"/edit/:id",component:w}),o.a.createElement(m.a,{path:"/create",component:w})))}}]),a}(n.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));r.a.render(o.a.createElement(o.a.StrictMode,null,o.a.createElement(L,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[53,1,2]]]);
//# sourceMappingURL=main.cf18eb47.chunk.js.map